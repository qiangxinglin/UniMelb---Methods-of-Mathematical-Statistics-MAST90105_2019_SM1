---
title: "Assignment 2"
author: "Vinh Nguyen (ID 1029531)"
output: html_notebook
---


```{r}
# Preliminaries
rm(list=ls())
```

1. A low pressure system (low) that forms in the Australian region has a chance of 8% to
    transform into a tropical cyclone.  
(a) Assume that 20 lows will form in April 2019. Find the probability that two of
them will transform into a tropical cyclone.  
Let X: number of lows that transform into a tropical cyclone (out of 20 lows) ~ Bi(n=20, p=0.08)  
**P(X = 2)**
```{r}
n <- 20
p <- 0.08
dbinom(2, size=n, prob=p)
```

(b) Find the probability that the first low that will transform into a tropical cyclone
in November 2019 will be the 5th low that will form in this month.  
Let Y: number of lows until first low that transforms into a tropical cyclone ~ Geom(p=0.08)  
**P(Y = 5)**
```{r}
p <- 0.08
k <- 5 # number of trials until first success
dgeom(k-1, prob=p)
```

(c) Find the probability that the second low that will transform into a tropical cyclone
in December 2019 will be the 15th low that will form in this month.  
P(2nd low that turns into cyclone is 15th low) = P(1 low turns into cyclone out of 14 lows and 15th low turns into cyclone)
Let X: number of cyclones formed from 14 lows ~ Bi(n=14, p=0.08)
Y: indicator for whether or not a low turns into cyclone ~ Ber(p=0.08)
$$
P(X=14 \cap Y=1) = P(X=14) P(Y=1) \text{ (assuming independence between formation of cyclone from each low)}
$$
```{r}
n <- 14
p <- 0.08
k <- 1
dbinom(k, size=n, prob=p) * p
```

(d) How many lows are expected to form before two of them transform to tropical
cyclones?  
Let Z: number of lows formed before 2 of them transform to cyclones (or until 2nd cyclone)
$$
Z = Z_1 + Z_2
$$
where:
$Z_1$: number of lows until 1st cyclone ~ Geom(p=0.08)
$Z_2$: number of lows from 1st cyclone to 2nd cyclone ~ Geom(p=0.08)
$$
E(Z) = E(Z_1) + E(Z_2) = 2E(Z_1)
$$
```{r}
p <- 0.08
2 * 1/p
```

(e) Assume that 150 lows in total will form between November 1st, 2019 and April
30th, 2020. Find the probability that at least 10 of them will transform into
tropical cyclones.  
- Compute the exact probability  
Let W: number of cyclones formed out of 150 lows ~ Bi(n=150, p=0.08)  
$$
P(W \geq 10) = 1 - P(W \leq 9) = 1 - F_W(9)
$$
```{r}
n <- 150
p <- 0.08
k <- 9
1 - pbinom(k, size=n, prob=p) 
```

- Compute this probability using the Poisson approximation  
W ~ Poiss($\lambda$)  
where: $\lambda$ = np = 150 * 0.08  
**P(W >= 10)**  
```{r}
lambda <- 150 * 0.08
k <- 9
1 - ppois(k, lambda=lambda)
```

2. The telephone calls received by a call center follow a Poisson process with the rate of
8 calls per minute.  
```{r}
call_rate <- 8 # per minute
```
(a) Find the probability that the call center receives exactly 45 calls in 5 minutes.  
X: number of calls in 5 minutes ~ Poiss($\lambda = 8*5$)  
**P(X=45)**  
```{r}
lambda <- 5 * call_rate
k <- 45
dpois(k, lambda=lambda)
```

(b) Find the probability that the call center receives at least 500 calls in one hour
and at most 500 calls in the following hour.  
Y: number of calls in an hour (60 minutes) ~ Poiss($\lambda = 60*8$)  
**Probability of interest** = P(Y >= 500) P(Y <= 500) = (1 - P(Y <= 499)) P(Y <= 500)  
```{r}
lambda <- 60 * call_rate
k1 <- 499
k2 <- 500
(1 - ppois(k1, lambda=lambda)) * ppois(k2, lambda=lambda)
```

(c) How many calls the call center is expected to receive in 8 hours? Find the standard
deviation of the number of calls received in 8 hours.  
Z: number of calls in 8 hours ~ Poiss($\lambda = 8*60*8$)  
**E(Z)** = $\lambda$  
**Standard deviation** = $\sigma = \sqrt{\lambda}$  
```{r}
lambda <- 8 * 60 * call_rate
"Expected value"
lambda
"Standard deviation"
sqrt(lambda)
```

(d) Assume now that the call center cannot receive more than 10 calls in 1 minute due
to limited capacity. If more calls arrive, then some of them will not be answered.
Find the probability that all calls will be answered in 10 minutes. Find the mean
of the time (in minutes) to the first unanswered call.  
W: number of calls in 1 minute ~ Poiss($\lambda = 8$)  
**P(all calls will be answered in 10 minutes)** = P(Number of calls in 1st minute <= 10) P(Number of calls in 2nd munite <= 10) ... P(Number of calls in 10th minute <= 10)  
= $\big( P(W \leq 10) \big)^{10}$  
```{r}
lambda <- call_rate
k <- 10
(ppois(k, lambda=lambda))^10
```
P(first unanswered call arrives in each minute)  
= P(time to 11th call <= 1 minute)  
= 1 - P(time to 11th call > 1 minute)  
= 1 - P(10 calls or less in 1 minute)  
= 1 - P(W <= 10)
= p  
K: number of minutes to the first unanswered call ~ Geom(p)  
**E(K)** = $\frac{1}{p}$  
```{r}
lambda <- call_rate
k <- 10
p <- 1 - ppois(k, lambda=lambda)
1/p
```

3. A random variableXhas a pdf given by  
f(x) = {Ce^2 x, x < 0 , Ce−x, x≥ 0.  
(a) Find the normalizing constantC.
(b) Find the cdf ofX.
(c) Let− 2 < t < 1. FindMX(t) = E(eXt), the moment generating function ofX.
(d) UseMX(t)to find the mean and variance ofX,E(X)andVar(X).
(e) Find the median ofX.

4. LetXandYhave the joint pdf defined by  
f(x,y) = {C(x+y), 0 < x < 1 , 0 < y < 1 , 0 , otherwise.
(a) Find the normalizing constantC.
(b) FindF(x,y) = Pr(X < x,Y < y)for anyx,yand computePr(X < 0. 4 ,Y < 0 .6).
(c) ComputeμX= E(X),μY= E(Y),σ^2 X= Var(X),σ^2 Y = Var(Y),Cov(X,Y), and
ρ= Cor(X,Y).

5. LetX andY be jointly normal random variables with parametersE(X) = E(Y) =
    0 , Var(X) = Var(Y) = 1, andCor(X,Y) =ρ.  
(a) Findρsuch thatW 1 = 0. 6 X+ 0. 8 Y andW 2 = 0. 8 X+ 0. 6 Y are independent.
(b) FindPr(X < 1 |X=Y)ifρ= 0. 6.



